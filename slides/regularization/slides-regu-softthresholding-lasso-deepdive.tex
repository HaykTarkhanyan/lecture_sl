\documentclass[11pt,compress,t,notes=noshow, xcolor=table]{beamer}
\input{../../style/preamble}
\input{../../latex-math/basic-math}
\input{../../latex-math/basic-ml}

\newcommand{\titlefigure}{figure/th_l1_pos.pdf}
\newcommand{\learninggoals}{
  \item Understand the relationship between soft-thresholding and L1 regularization
}

\title{Introduction to Machine Learning}
\date{}

\begin{document}

\lecturechapter{Soft-thresholding and L1 regularization deep-dive}
\lecture{Introduction to Machine Learning}



\begin{vbframe}{Soft-thresholding and L1 regularization}
In the lecture, we wanted to solve
     \[
      \min_{\thetab} \mathcal{\tilde R}_{\text{reg}}(\thetab) =  \min_{\thetab}\mathcal{R}_{\text{emp}}(\thetah) + \sum_j \left[ \frac{1}{2} H_{j,j} (\theta_j - \hat{\theta}_j)^2 \right] + \sum_j \lambda |\theta_j|.
      \]
Note that we can separate the dimensions, i.e.,

\[\mathcal{\tilde R}_{\text{reg}}(\thetab) = \sum_j g_j(\theta_j) \text{ with } g_j(\theta_j) = \frac{1}{2} H_{j,j} (\theta_j - \hat{\theta}_j)^2 + \lambda |\theta_j|.\]
      
Hence, we can minimize each $g_j$ separately to find the global minimum. \\
\lz

Each $g_j$ is convex since it is a sum of convex functions. For convex functions, every stationary point is a minimum. \\
\lz



\framebreak

Thus, we analyze the stationary points $\hat{\theta}_{\text{Lasso},j}$ of $g_j.$ \\
\lz 
For this, we assume we already know the sign of the minimizer and then derive conditions for which our assumption holds. \\
\lz 
So, first we consider the cases $\hat{\theta}_{\text{Lasso},j} > 0, \hat{\theta}_{\text{Lasso},j} < 0.$\\
\lz
NB: 
\begin{itemize}
    \item For $\theta_j > 0: \frac{d}{d\theta_j}\vert \theta_j\vert = \frac{d}{d\theta_j}\theta_j = 1$ and 
    \item For $\theta_j < 0: \frac{d}{d\theta_j}\vert \theta_j\vert = \frac{d}{d\theta_j}\left(-\theta_j\right) = -1$.
\end{itemize}

\framebreak

1) $\hat{\theta}_{\text{Lasso},j} > 0:$ \\
\lz
\begin{minipage}{0.4\textwidth}
    \includegraphics[width=5cm]{figure/th_l1_pos.pdf}
\end{minipage}
\hfill
\begin{minipage}{0.49\textwidth}
\begin{align*}
    \frac{d}{d \theta_j}g_j(\theta_j) &= H_{j,j}\theta_j - H_{j,j} \hat{\theta}_j + \lambda \overset{!}{=} 0 \\
    &\Rightarrow  \hat{\theta}_{\text{Lasso},j} = \hat{\theta}_j 
 -\frac{\lambda}{H_{j,j}} > 0 \\
 &\iff \hat{\theta}_j >  \frac{\lambda}{H_{j,j}}
\end{align*}
\end{minipage}
 \newpage

2) $\hat{\theta}_{\text{Lasso},j} < 0:$ \\
\lz
\begin{minipage}{0.4\textwidth}
    \includegraphics[width=5cm]{figure/th_l1_neg.pdf}
\end{minipage}
\hfill
\begin{minipage}{0.49\textwidth}
\begin{align*}
    \frac{d}{d \theta_j}g_j(\theta_j) &= H_{j,j}\theta_j - H_{j,j} \hat{\theta}_j - \lambda \overset{!}{=} 0 \\
    &\Rightarrow  \hat{\theta}_{\text{Lasso},j} = \hat{\theta}_j 
 +\frac{\lambda}{H_{j,j}} < 0 \\
 &\iff \hat{\theta}_j < -\frac{\lambda}{H_{j,j}}
\end{align*}
\end{minipage}
 \newpage


\begin{minipage}{0.4\textwidth}
    \includegraphics[width=5cm]{figure/th_l1_zero.pdf}
\end{minipage}
\hfill
\begin{minipage}{0.49\textwidth}
$\Rightarrow$ If $\hat{\theta}_j \in [-\frac{\lambda}{H_{j,j}}, \frac{\lambda}{H_{j,j}}]$ then $g_j$ has no stationary point with $$\hat{\theta}_{\text{Lasso},j} < 0 \text{ or } \hat{\theta}_{\text{Lasso},j} > 0.$$ \\
However, at least one stationary point must exist since $g_j$ is a regularized convex function with $\lambda > 0.$\\
$(\Rightarrow$ An equivalent constraint with $\vert\theta_j\vert \leq t \in\R_+$ must exist.)
\end{minipage}
 \\

\begin{align*}\Rightarrow \hat{\theta}_{\text{Lasso},j} &= \begin{cases} 
     \hat{\theta}_j + \frac{\lambda}{H_{j,j}} &, \text{if}   \;\hat{\theta}_j < -\frac{\lambda}{H_{j,j}} \\
       0 &, \text{if}   \;\hat{\theta}_j \in [-\frac{\lambda}{H_{j,j}}, \frac{\lambda}{H_{j,j}}] \\
     \hat{\theta}_j - \frac{\lambda}{H_{j,j}} &, \text{if}   \;\hat{\theta}_j > \frac{\lambda}{H_{j,j}} \\
     \end{cases}
     \end{align*}

\end{vbframe}

\endlecture
\end{document}

